# Project Tasks

> AI Review Analyst 프로젝트 작업 관리 문서

**범례:**
- [ ] 미완료
- [x] 완료
- Phase > Epic > Task 계층 구조

---

## Phase 1: Foundation (프로젝트 기반 구축)

### Epic 1.1: 프로젝트 환경 설정

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 1.1.1 | [x] Python 가상환경 생성 | 완료 | `python -m venv venv` |
| 1.1.2 | [x] requirements.txt 작성 | 완료 | 의존성 패키지 정의 |
| 1.1.3 | [x] .env.example 생성 | 완료 | 환경 변수 템플릿 |
| 1.1.4 | [x] .gitignore 설정 | 완료 | venv, .env, __pycache__ 등 |
| 1.1.5 | [x] 프로젝트 디렉토리 구조 생성 | 완료 | src/, tests/, data/ 등 |
| 1.1.6 | [x] config.py 설정 모듈 작성 | 완료 | pydantic-settings 활용 |

**완료 기준:** `pip install -r requirements.txt` 실행 시 에러 없이 설치 완료

---

### Epic 1.2: 웹 크롤러 개발

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 1.2.1 | [x] Playwright 설치 및 브라우저 설정 | 완료 | `playwright install chromium` |
| 1.2.2 | [x] 기본 크롤러 클래스 구현 | 완료 | `src/crawler/base.py` |
| 1.2.3 | [x] 올웨이즈 리뷰 크롤러 구현 | 완료 | 동적 페이지 스크롤 처리 |
| 1.2.4 | [x] 쿠팡 리뷰 크롤러 구현 | 완료 | 플랫폼별 파서 분리 |
| 1.2.5 | [x] 크롤링 에러 핸들링 | 완료 | 재시도, 타임아웃 처리 |
| 1.2.6 | [x] User-Agent 로테이션 구현 | 완료 | 차단 우회 전략 |
| 1.2.7 | [x] 크롤러 단위 테스트 작성 | 완료 | `tests/test_crawler.py` |
| 1.2.8 | [x] playwright-stealth 통합 | 완료 | 봇 탐지 우회 강화 |
| 1.2.9 | [x] 인간적 행동 패턴 구현 | 완료 | 랜덤 딜레이, 스크롤 |

**완료 기준:** URL 입력 시 리뷰 데이터 JSON 형태로 추출 성공

**⚠️ 알려진 한계점:**
- **쿠팡**: 강력한 봇 탐지 시스템(Akamai) 사용으로 headless 브라우저 차단
  - 프록시 서비스 또는 CAPTCHA 해결 서비스 필요
  - 프로덕션 환경에서는 공식 API 또는 파트너십 고려 권장
- **올웨이즈**: 모바일 앱 중심 서비스로 웹 버전 제한적
- **11번가/네이버쇼핑**: 봇 탐지로 접속 차단

**💡 대안:** 크롤링 한계로 인해 **AI Hub 공개 데이터셋**을 활용하여 RAG 파이프라인 및 에이전트 시스템 개발에 집중

---

### Epic 1.3: 공개 데이터셋 통합 (AI Hub) ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 1.3.1 | [x] AI Hub 회원가입 및 데이터 신청 | 완료 | 승인 완료 |
| 1.3.2 | [x] 데이터셋 다운로드 | 완료 | `data/aihub_data/` |
| 1.3.3 | [x] 데이터 포맷 변환 | 완료 | `src/pipeline/aihub_loader.py` |
| 1.3.4 | [x] 카테고리별 데이터 분리 | 완료 | 패션/화장품/가전/IT/생활용품 |
| 1.3.5 | [x] 샘플 데이터 생성 | 완료 | `data/aihub_sample*.json` |

**데이터셋 정보:**
- **출처:** [AI Hub - 속성기반 감정분석 데이터](https://aihub.or.kr/aihubdata/data/view.do?dataSetSn=71603)
- **실제 규모:** 225,285건 (쇼핑몰 90% + SNS 10%)
- **카테고리:** 패션, 화장품, 가전, IT기기, 생활용품 (각 약 20%)
- **라벨:** 속성별 감정 태깅 (가격, 디자인, 기능, 품질, 색상 등)
- **형식:** JSON
- **활용:** RAG 학습, 속성별 감성 분석, 상품 비교

**생성된 파일:**
- `src/pipeline/aihub_loader.py`: AI Hub 데이터 로더 클래스
- `data/aihub_sample.json`: 통합 샘플 (1,000건)
- `data/aihub_sample_{카테고리}.json`: 카테고리별 샘플 (각 200건)

---

### Epic 1.4: 데이터 전처리 파이프라인 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 1.4.1 | [x] 리뷰 텍스트 정제 함수 | 완료 | 특수문자, 이모지 처리 |
| 1.4.2 | [x] 텍스트 청킹(Chunking) 로직 | 완료 | 의미 단위 분할 |
| 1.4.3 | [x] 메타데이터 추출 | 완료 | 별점, 날짜, 구매옵션 |
| 1.4.4 | [x] 중복 리뷰 필터링 | 완료 | 해시 기반 중복 제거 |
| 1.4.5 | [x] 전처리 파이프라인 클래스 | 완료 | `src/pipeline/preprocessor.py` |
| 1.4.6 | [x] 전처리 단위 테스트 | 완료 | `tests/test_preprocessor.py` |

**완료 기준:** 원본 리뷰 → 정제된 청크 리스트 변환 정상 동작

**구현 내용:**
- `TextCleaner`: 텍스트 정제 클래스 (이모지, 특수문자, 반복문자, HTML 엔티티 처리)
- `TextChunker`: 텍스트 청킹 클래스 (문장 단위 분할, 오버랩 지원)
- `DuplicateFilter`: 중복 필터링 클래스 (해시 기반 + 퍼지 매칭)
- `ReviewPreprocessor`: 통합 파이프라인 클래스
- 39개 단위 테스트 전체 통과

---

## Phase 2: Core RAG (검색 증강 생성 구현)

### Epic 2.1: Vector Database 구축 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 2.1.1 | [x] ChromaDB 설치 및 초기화 | 완료 | 영속적 저장소 설정 |
| 2.1.2 | [x] OpenAI 임베딩 연동 | 완료 | text-embedding-3-small |
| 2.1.3 | [x] 임베딩 파이프라인 구현 | 완료 | `src/pipeline/embedder.py` |
| 2.1.4 | [x] 컬렉션 관리 유틸리티 | 완료 | 생성, 삭제, 조회 |
| 2.1.5 | [x] 메타데이터 필터링 구현 | 완료 | 별점, 날짜 기반 필터 |
| 2.1.6 | [x] 벡터 검색 테스트 | 완료 | 유사도 검색 정확도 확인 |

**완료 기준:** 자연어 쿼리로 관련 리뷰 Top-K 검색 성공

**구현 내용:**
- `ReviewEmbedder`: 리뷰 임베딩 및 벡터 검색 클래스
- `CollectionManager`: ChromaDB 컬렉션 관리 유틸리티
- `SearchResult`: 검색 결과 데이터 구조
- 메타데이터 필터링 (평점, 날짜) 지원
- LangChain Retriever 통합
- 16개 단위 테스트 통과

---

### Epic 2.2: LangChain RAG Chain 구현 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 2.2.1 | [x] LangChain 기본 설정 | 완료 | ChatOpenAI 초기화 |
| 2.2.2 | [x] Retriever 구성 | 완료 | ChromaDB 연동 |
| 2.2.3 | [x] 프롬프트 템플릿 설계 | 완료 | 시스템/유저 프롬프트 |
| 2.2.4 | [x] RetrievalQA Chain 구현 | 완료 | `src/chains/rag_chain.py` |
| 2.2.5 | [x] 출처(Source) 반환 로직 | 완료 | 참고 리뷰 원문 표기 |
| 2.2.6 | [x] Chain 스트리밍 설정 | 완료 | 실시간 응답 출력 |
| 2.2.7 | [x] RAG Chain 통합 테스트 | 완료 | E2E 질의응답 테스트 |

**완료 기준:** "배송이 빠른가요?" 질문에 리뷰 근거 기반 답변 생성

**구현 내용:**
- `ReviewRAGChain`: RAG 체인 클래스 (query, stream, astream 메서드)
- `RAGConfig`: 설정 데이터클래스 (모델, 온도, top_k 등)
- `RAGResponse`: 응답 데이터클래스 (답변, 출처, 메타데이터)
- 시스템 프롬프트: 리뷰 분석 전문가 역할, 근거 기반 답변 원칙
- 스트리밍 지원 (동기/비동기)
- 23개 단위 테스트 통과

---

### Epic 2.3: 프롬프트 엔지니어링 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 2.3.1 | [x] Q&A 시스템 프롬프트 작성 | 완료 | 역할, 제약조건 정의 |
| 2.3.2 | [x] 요약 프롬프트 작성 | 완료 | 수치화 근거 포함 지시 |
| 2.3.3 | [x] 비교 분석 프롬프트 작성 | 완료 | 장단점 비교 포맷 |
| 2.3.4 | [x] 할루시네이션 방지 지시문 | 완료 | "모르면 모른다고 답변" |
| 2.3.5 | [x] Few-shot 예시 추가 | 완료 | 답변 품질 향상 |
| 2.3.6 | [x] 프롬프트 버전 관리 | 완료 | prompts/ 디렉토리 구성 |

**완료 기준:** 일관된 포맷과 품질의 답변 생성

**구현 내용:**
- `src/prompts/templates.py`: 프롬프트 템플릿 모듈
- `PromptTemplate`: 프롬프트 데이터 구조 (시스템/유저 프롬프트, Few-shot 예시)
- `PromptManager`: 프롬프트 관리 클래스 (등록, 조회, 타입별 필터)
- 4가지 프롬프트: Q&A, 요약, 비교분석, 감성분석
- 할루시네이션 방지 지시문 (ANTI_HALLUCINATION_INSTRUCTIONS)
- RAG Chain 통합 (set_prompt, set_prompt_template 메서드)
- 29개 단위 테스트 통과

---

### Epic 2.4: LLM 기반 속성 추출 시스템

> **목표:** 실제 프로덕션 환경처럼 라벨이 없는 Raw 리뷰에서 LLM을 활용해 속성(Aspect)을 자동 추출하는 시스템

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 2.4.1 | [x] AspectExtractor 클래스 구현 | 완료 | `src/pipeline/aspect_extractor.py` |
| 2.4.2 | [x] 속성 추출 프롬프트 설계 | 완료 | 11개 카테고리 정의 |
| 2.4.3 | [x] 속성별 감정 분석 | 완료 | Structured Output 활용 |
| 2.4.4 | [x] 배치 처리 및 캐싱 | 완료 | MD5 해시 기반 캐싱 |
| 2.4.5 | [x] UI: 속성별 차트 시각화 | 완료 | 속성별 감정 분포 차트 |
| 2.4.6 | [x] UI: 속성 필터 기능 | 완료 | 감정 토글 필터 (긍정/부정/중립) |
| 2.4.7 | [x] UI: 제품 비교 뷰 | 완료 | 속성별 제품 간 비교 |
| 2.4.8 | [x] UI: 사용자 리뷰 추가 기능 | 완료 | Raw 리뷰 → LLM 분석 → DB 저장 |

**완료 기준:** Raw 리뷰 입력 시 속성별 감정 분석 결과 및 시각화 출력

**구현 내용 (Epic 2.4 전체 완료 ✅):**
- `src/pipeline/aspect_extractor.py`: 속성 추출기 모듈
- `AspectExtractor`: LLM 기반 속성 추출 클래스
- `AspectResult`: 추출 결과 데이터 구조
- `Sentiment`, `AspectCategory`: Enum 정의
- Pydantic Structured Output 활용
- 28개 속성 카테고리 지원 (확장됨)
- MD5 해시 기반 캐싱 시스템
- 27개 단위 테스트 통과 (`tests/test_aspect_extractor.py`)

**UI 구현 내용 (2.4.5~2.4.8 완료):**
- **제품 비교 뷰**: 2-4개 제품 동시 비교, 속성별 감정 비교 차트
- **사용자 리뷰 추가**: 별점 입력, LLM 분석, 결과 저장
- `src/pipeline/user_review_store.py`: 사용자 리뷰 저장소 모듈
- `UserReview`, `UserReviewStore` 클래스

**배경:**
- 실제 프로덕션 환경에서는 AI Hub처럼 사전 라벨링된 Aspects 데이터가 없음
- Raw 리뷰 텍스트만으로 속성을 추출하고 감정을 분석해야 함
- 이 시스템으로 어떤 이커머스 리뷰든 분석 가능

**추출 대상 속성 카테고리:**
- 가격/가성비
- 디자인/외관
- 사이즈/치수
- 소재/품질
- 배송/포장
- 색상
- 기능/성능
- 착용감/편안함
- 내구성
- 서비스/응대
- 기타

---

## Phase 3: Agent System (멀티 에이전트 구현)

### Epic 3.1: LangGraph 기반 에이전트 구조 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 3.1.1 | [x] AgentState 정의 | 완료 | `src/agents/state.py` |
| 3.1.2 | [x] Intent Classifier 노드 | 완료 | `src/agents/intent_classifier.py` |
| 3.1.3 | [x] Conditional Router 구현 | 완료 | `src/agents/graph.py` |
| 3.1.4 | [x] StateGraph 구성 | 완료 | `src/agents/graph.py` |
| 3.1.5 | [x] 그래프 시각화 테스트 | 완료 | `get_graph_visualization()` |

**완료 기준:** 질문 유형에 따라 올바른 에이전트로 라우팅

**구현 내용:**
- `AgentState`: TypedDict 상태 스키마 (query, intent, response 등)
- `IntentType`: QA, SUMMARY, COMPARE, UNKNOWN Enum
- Intent Classifier: 하이브리드 방식 (규칙 기반 + LLM 기반)
- StateGraph: START → Intent Classifier → Router → [QA|Summary|Compare] → END

---

### Epic 3.2: 개별 에이전트 구현 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 3.2.1 | [x] Summarize Agent 구현 | 완료 | `src/agents/summarize_agent.py` |
| 3.2.2 | [x] Q&A Agent 구현 | 완료 | `src/agents/qa_agent.py` |
| 3.2.3 | [x] Compare Agent 구현 | 완료 | `src/agents/compare_agent.py` |
| 3.2.4 | [x] 에이전트 공통 인터페이스 | 완료 | `src/agents/base.py` |
| 3.2.5 | [x] 에이전트 단위 테스트 | 완료 | `tests/test_agents.py` (8개 테스트) |

**완료 기준:** 3가지 에이전트가 독립적으로 동작

**구현 내용:**
- `BaseAgent`: 추상 기본 클래스 (RAG Chain 래핑, 프롬프트 설정)
- `QAAgent`: RAG 기반 질의응답 (qa 프롬프트)
- `SummarizeAgent`: 리뷰 요약 (summary 프롬프트, top_k=10)
- `CompareAgent`: 제품 비교 분석 (compare 프롬프트)

---

### Epic 3.3: 가짜 리뷰 필터링 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 3.3.1 | [x] 어뷰징 패턴 정의 | 완료 | 과도한 칭찬, 스팸, 반복 등 |
| 3.3.2 | [x] LLM 기반 분류기 구현 | 완료 | 하이브리드 탐지 (규칙+LLM) |
| 3.3.3 | [x] 필터링 임계값 설정 | 완료 | 가중치 계산 로직 |
| 3.3.4 | [x] 테스트 작성 및 검증 | 완료 | 15개 테스트 통과 |

**완료 기준:** 의심 리뷰 필터링 또는 가중치 감소 적용

**구현 내용:**
- `src/pipeline/fake_review_filter.py`: 가짜 리뷰 필터 모듈
- `FakeReviewFilter`: 하이브리드 탐지 클래스 (규칙 기반 + LLM)
- `FakeReviewReason`: 의심 사유 Enum (7가지)
- `FakeReviewResult`: 판정 결과 데이터클래스

**탐지 패턴:**
- 과도한 칭찬 (인생템, 최고의 제품, 무조건 사세요 등)
- 스팸/광고 키워드 (협찬, 체험단, 카톡 문의 등)
- 반복 패턴 (동일 단어 3회 이상)
- 너무 짧은 리뷰 (10자 미만)
- 구체성 부족 (제품 특성 언급 없음)
- 평점-내용 불일치 (높은 평점 + 부정 내용)

**가중치 계산:**
- 정상 리뷰: 1.0
- 의심 리뷰: confidence에 따라 0.2~0.75
- 스팸 리뷰: 추가 50% 감소

---

## Phase 4: UI & Polish (사용자 인터페이스)

### Epic 4.1: Streamlit 대시보드 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 4.1.1 | [x] 기본 레이아웃 구성 | 완료 | 헤더, 사이드바, 메인 |
| 4.1.2 | [x] 데이터 로더 컴포넌트 | 완료 | AI Hub 데이터 로드 |
| 4.1.3 | [x] 로딩 상태 표시 | 완료 | 스피너, 프로그레스 바 |
| 4.1.4 | [x] 요약 리포트 카드 | 완료 | 긍/부정 비율, 메트릭 |
| 4.1.5 | [x] 차트 시각화 | 완료 | bar chart (평점/감성 분포) |
| 4.1.6 | [x] 채팅 인터페이스 | 완료 | st.chat_message 활용 |
| 4.1.7 | [x] 세션 상태 관리 | 완료 | 대화 히스토리 유지 |

**완료 기준:** 데이터 로드 → 요약 → 채팅 플로우 정상 동작

**버그 수정 (Issue #19):**
- ReviewScore 문자열/None/빈값 파싱 처리
- SNS 데이터 GeneralPolarity 기반 평점 추정
- original_text 전체 저장 (500자 제한 제거)
- RAG 소스에서 original_text 우선 사용
- API 호출 파라미터 수정 (카테고리명, category= 파라미터)

---

### Epic 4.4: 쇼핑몰 스타일 UI 개편 ✅ (Issue #21)

> **목표:** 제품 목록 → 제품 상세 → 리뷰 분석/Q&A 형태의 직관적인 쇼핑몰 UX

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 4.4.1 | [x] Product 데이터클래스 추가 | 완료 | 제품 정보 구조화 |
| 4.4.2 | [x] get_products() 메서드 | 완료 | 제품별 리뷰 그룹화 |
| 4.4.3 | [x] 제품 목록 페이지 | 완료 | 카드 그리드, 필터/정렬 |
| 4.4.4 | [x] 제품 상세 페이지 | 완료 | 4개 탭 구성 |
| 4.4.5 | [x] 제품별 RAG Q&A | 완료 | 해당 제품 리뷰만으로 RAG |

**완료 기준:** 제품 선택 → 상세 분석 → Q&A 플로우 정상 동작

**구현 내용:**
- `src/pipeline/aihub_loader.py`: Product 클래스, get_products() 추가
- `src/ui/app.py`: 쇼핑몰 스타일 UI로 전면 개편

**제품 목록 페이지:**
- 카드 그리드 형태 제품 표시 (3열)
- 카테고리 필터링
- 검색 및 정렬 (리뷰 많은순, 평점 높은순)
- 제품별 평점, 리뷰 수, 감정 요약 표시
- 주요 속성 태그 표시
- ✅ 페이지네이션 (12개/페이지, 상하단 네비게이션)

**제품 상세 페이지 (4개 탭):**
- 📊 요약: 감정 분포 차트, 주요 속성, 자동 인사이트
- 🏷️ 속성 분석: AI Hub 라벨 기반 속성별 감정 분석
  - ✅ 전체 리뷰 텍스트 + 속성 하이라이트 (감정별 색상)
  - ✅ 감정 토글 필터 (긍정/부정/중립)
  - ✅ 페이지네이션 (10개/페이지)
- 💬 Q&A: 해당 제품 리뷰만으로 RAG 기반 질의응답
- 📋 리뷰 목록: 감정 필터링/정렬 가능

**실행:** `streamlit run src/ui/app.py`

---

### Epic 4.2: UX 개선 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 4.2.1 | [x] 스트리밍 응답 구현 | 완료 | st.write_stream 활용 |
| 4.2.2 | [x] 에러 메시지 사용자화 | 완료 | 친절한 에러 안내 + 해결 방법 |
| 4.2.3 | [x] 출처 리뷰 펼쳐보기 | 완료 | expander 컴포넌트 (기존 구현) |
| 4.2.4 | [x] 분석 결과 다운로드 | 완료 | JSON/CSV 내보내기 |
| 4.2.5 | [x] 반응형 디자인 조정 | 완료 | 모바일/태블릿 CSS |
| 4.2.6 | [-] 다크모드 지원 | 스킵 | 불필요 |

**완료 기준:** 사용자 피드백 기반 UX 개선 완료

**구현 내용:**
- **스트리밍 응답**: `stream_with_sources()` 메서드로 실시간 타이핑 효과
- **에러 메시지**: 유형별 친절한 안내 (API 키, Rate limit, 네트워크 등)
- **데이터 다운로드**: 요약(JSON), 리뷰(CSV), 속성 분석(JSON)
- **반응형 디자인**: 768px/1024px 브레이크포인트, 모바일 1열 레이아웃

---

### Epic 4.3: 에러 핸들링 및 로깅 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 4.3.1 | [x] 로깅 설정 | 완료 | `src/core/logging.py` |
| 4.3.2 | [x] 예외 클래스 정의 | 완료 | `src/core/exceptions.py` |
| 4.3.3 | [x] API 에러 처리 | 완료 | 커스텀 예외 + 에러 핸들러 통합 |
| 4.3.4 | [x] 크롤링 실패 처리 | 완료 | 예외 클래스 정의 완료 |
| 4.3.5 | [x] 사용자 알림 시스템 | 완료 | Epic 4.2에서 구현 |

**완료 기준:** 모든 예상 에러 케이스에 대한 graceful 처리

**구현 내용:**
- `src/core/logging.py`: 로깅 설정 모듈
  - `setup_logging()`: 콘솔/파일 로깅 초기화
  - `get_logger()`: 모듈별 로거 반환
- `src/core/exceptions.py`: 커스텀 예외 클래스
  - `ReviewAnalystError`: 기본 예외 (message, details, suggestion)
  - `APIError`, `RateLimitError`, `AuthenticationError`
  - `DataLoadError`, `CrawlerError`, `EmbeddingError`, `RAGError`
- RAG Chain에 로깅 통합
- UI 에러 핸들러에 커스텀 예외 지원

---

## Phase 5: Deployment (배포)

### Epic 5.1: 컨테이너화 (스킵)

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 5.1.1 | [-] Dockerfile 작성 | 스킵 | 직접 배포로 대체 |
| 5.1.2 | [-] docker-compose.yml 작성 | 스킵 | 직접 배포로 대체 |
| 5.1.3 | [-] .dockerignore 설정 | 스킵 | 직접 배포로 대체 |
| 5.1.4 | [-] 로컬 Docker 빌드 테스트 | 스킵 | 직접 배포로 대체 |
| 5.1.5 | [-] 볼륨 마운트 설정 | 스킵 | EC2 EBS로 영속성 확보 |

**스킵 사유:** t3.micro 메모리 제약, 직접 배포로 충분

---

### Epic 5.2: AWS EC2 배포 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 5.2.1 | [x] EC2 인스턴스 생성 | 완료 | t3.micro, Ubuntu 24.04 |
| 5.2.2 | [x] 보안 그룹 설정 | 완료 | SSH(22), Streamlit(8501) |
| 5.2.3 | [x] Python 환경 설정 | 완료 | Python 3.12, venv, setuptools |
| 5.2.4 | [x] 소스 코드 배포 | 완료 | rsync + 데이터 SCP |
| 5.2.5 | [x] 환경 변수 설정 | 완료 | .env 파일 생성 |
| 5.2.6 | [x] 앱 실행 | 완료 | streamlit run |
| 5.2.7 | [-] 도메인 연결 (선택) | 스킵 | 데모용이라 불필요 |

**완료 기준:** 퍼블릭 IP로 서비스 접속 가능 ✅

---

### Epic 5.3: 운영 및 모니터링 (스킵)

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 5.3.1 | [-] 헬스체크 엔드포인트 | 스킵 | 데모용 불필요 |
| 5.3.2 | [-] 로그 수집 설정 | 스킵 | 데모용 불필요 |
| 5.3.3 | [-] 자동 재시작 설정 | 스킵 | 데모용 불필요 |
| 5.3.4 | [-] 백업 스크립트 작성 | 스킵 | 데모용 불필요 |
| 5.3.5 | [-] 배포 자동화 (선택) | 스킵 | 데모용 불필요 |

**스킵 사유:** 데모/포트폴리오 목적으로 프로덕션 수준 운영 불필요

---

## Phase 6: Testing & Documentation (테스트 및 문서화)

### Epic 6.1: 테스트 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 6.1.1 | [x] pytest 설정 | 완료 | conftest.py 구성됨 |
| 6.1.2 | [x] 단위 테스트 작성 | 완료 | 256개 테스트 (246 통과) |
| 6.1.3 | [-] 통합 테스트 작성 | 스킵 | 단위 테스트로 충분 |
| 6.1.4 | [x] 테스트 커버리지 측정 | 완료 | pytest-cov, 44% 커버리지 |
| 6.1.5 | [-] RAG 품질 평가 | 스킵 | 데모 목적으로 불필요 |

**결과:**
- 246개 테스트 통과, 10개 스킵
- agents 모듈: intent_classifier(100%), qa_agent(100%), summarize_agent(96%), compare_agent(97%), base(95%)
- aihub_loader: 68%
- 핵심 모듈: prompts(100%), fake_review_filter(88%), preprocessor(80%)
- 크롤러/UI는 테스트 어려움으로 제외

---

### Epic 6.2: 문서화

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 6.2.1 | [x] README.md 작성 | 완료 | 프로젝트 소개 |
| 6.2.2 | [x] PRD.md 작성 | 완료 | 요구사항 문서 |
| 6.2.3 | [x] TechStack.md 작성 | 완료 | 기술 스택 문서 |
| 6.2.4 | [x] Tasks.md 작성 | 완료 | 작업 관리 문서 |
| 6.2.5 | [x] API 문서 작성 | 완료 | `docs/API.md` |
| 6.2.6 | [x] 사용자 가이드 작성 | 완료 | `docs/UserGuide.md` |

**완료 기준:** 신규 개발자가 문서만으로 프로젝트 이해 가능

---

## Phase 7: Consumer Review UX (소비자 리뷰 경험)

> **목표:** 소비자가 리뷰를 통해 구매 결정을 빠르게 내릴 수 있도록 직관적인 UX 제공

### Epic 7.1: 제품 상세 페이지 개편 ✅ (전체 완료)

> **대상:** 구매를 고민하는 일반 소비자

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 7.1.1 | [x] 추천 판단 + 이유 | 완료 | 속성 기반 강점/약점 분석 |
| 7.1.2 | [x] 속성별 상세 리뷰 | 완료 | expander 형식, 감정별 하이라이트 |
| 7.1.3 | [x] 대표 리뷰 개선 | 완료 | 별점 + 속성 분석 토글 |
| 7.1.4 | [x] AI Q&A + 근거 리뷰 | 완료 | 답변 시 참고한 리뷰 목록 표시 |
| 7.1.5 | [x] 전체 리뷰 (시간순) | 완료 | 페이지네이션, 최신순 정렬 |
| 7.1.6 | [x] 리뷰 작성 기능 | 완료 | 사용자 리뷰 추가 + 자동 스크롤 |

**완료 기준:** 5초 내 구매 결정 도움 정보 제공

**구현 내용:**
- **추천 판단 + 이유**: `analyze_product_aspects()` 속성 기반 강점/약점 분석, 구체적 근거 제시
- **속성별 상세 리뷰**: HTML details/summary 토글, 감정별 색상 (긍정=파랑, 중립=초록, 부정=빨강)
- **대표 리뷰**: 별점(⭐ N) 형식 통일, 속성 분석 섹션 추가
- **AI Q&A + 근거 리뷰**: `render_qa_sources()` 함수로 개선
  - `@st.fragment`로 Q&A 섹션 분리 (로딩 중 아래 섹션 영향 없음)
  - 감정별 색상 표시 (별점 기반)
  - 속성 태그 표시 (DB에서 aspects 조회)
  - 가짜 리뷰 의심 여부 + 사유 표시
  - 대화 히스토리에 출처 저장하여 이전 답변도 근거 확인 가능
- **전체 리뷰**: 감정별 색상 텍스트, [의심] 라벨, 5개/페이지 페이지네이션
- **리뷰 작성**: LLM 분석 후 DB 저장, 새 리뷰 자동 토글 열기 + 스크롤
- **별점 UI 통일**: 모든 별점 표시를 "⭐ N" 형식으로 통일
- **평점 변환 수정**: AI Hub 데이터의 100점/5점 척도 혼재 문제 해결

---

### Epic 7.2: 리뷰 신뢰도 표시 ✅

> **목표:** 가짜 리뷰 필터링(Epic 3.3) 결과를 UI에 표시하여 소비자가 신뢰할 수 있는 리뷰 판별

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 7.2.1 | [x] 전체 리뷰 [의심] 라벨 | 완료 | 의심 리뷰에 주황색 [의심] 표시 |
| 7.2.2 | [x] 속성별 상세리뷰 의심 표시 | 완료 | 동일한 [의심] 라벨 적용 |
| 7.2.3 | [x] 대표 리뷰 필터링 | 완료 | 신뢰도 높은 리뷰만 대표로 선정 |
| 7.2.4 | [x] 의심 리뷰 설명 캡션 | 완료 | "[의심] 표시 = 과도한 칭찬, 광고성 문구" |

**완료 기준:** 의심 리뷰가 시각적으로 구분됨

**구현 내용:**
- `check_review_text()` 헬퍼 함수로 텍스트+평점 기반 검사
- 의심 사유: 과도한 칭찬, 스팸 키워드, 반복 패턴, 짧은 리뷰, 구체성 부족, 평점-내용 불일치
- 대표 리뷰는 `is_suspicious=False`인 리뷰만 선정

---

### Epic 7.3: 리뷰 데이터 개선

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 7.3.1 | [ ] 임의 날짜 생성 | 미완료 | JSON에 날짜 없으므로 임의 생성 |
| 7.3.2 | [ ] 대표 리뷰 선정 로직 | 미완료 | 속성 언급 수 기준 |

**완료 기준:** 리뷰 데이터가 실제 서비스처럼 표시

---

### Epic 7.4: UI 일관성 개선 ✅ (Issue #27)

> **목표:** 제품 목록과 상세 페이지 간 UI 일관성 개선

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 7.4.1 | [x] 감정 표시 → 추천 판단 형식 통일 | 완료 | 🟡 보통 → 🤔 괜찮아요 형식 |
| 7.4.2 | [x] 비교 기능 제거 | 완료 | 사용하지 않는 기능 제거 |

**완료 기준:** 목록/상세 페이지 UI 일관성 확보, 불필요 기능 제거

**구현 내용:**
- **감정 표시 통일**: 제품 카드에서 `🟡 보통 (59% 긍정)` → `🤔 괜찮아요` 형식으로 변경

---

### Epic 7.5: Q&A 채팅 UX 개선 ✅

> **목표:** 카카오톡 스타일의 직관적인 Q&A 채팅 인터페이스 제공

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 7.5.1 | [x] 카카오톡 스타일 채팅 UI | 완료 | `st.chat_message()` 활용 |
| 7.5.2 | [x] 2단계 로딩 UX | 완료 | 질문 즉시 표시 → AI 응답 대기 |
| 7.5.3 | [x] 로딩 스피너 애니메이션 | 완료 | "리뷰 분석중" + 회전 스피너 |
| 7.5.4 | [x] 근거 리뷰 상세 표시 | 완료 | 별점, 감정, 속성 태그, 의심 여부 |
| 7.5.5 | [x] 핵심 문구 하이라이트 | 완료 | AI 응답 인용문 기반 하이라이트 |
| 7.5.6 | [x] 화면 깜빡임 수정 | 완료 | rerun 시 opacity 변경 방지 CSS |

**완료 기준:** 자연스러운 채팅 경험, 근거 리뷰 쉽게 확인

**구현 내용:**
- **채팅 UI**: `st.chat_message("user"/"assistant")` 네이티브 컴포넌트
- **2단계 로딩**: `pending_key` 상태로 질문 즉시 렌더링, AI 응답 후 업데이트
- **로딩 스피너**: CSS 애니메이션 (`@keyframes spin`), 텍스트 뒤 스피너 배치
- **근거 리뷰**: `st.popover`로 펼침, 별점/감정/속성 태그/가짜 리뷰 의심 표시
- **하이라이트**: AI 응답에서 따옴표 내 문구 추출 → 리뷰에서 해당 부분 배경색 처리
- **깜빡임 방지**: `opacity: 1 !important`, `transition: none !important` CSS
- **속성별 리뷰 미리보기**: 감정별 배경색 하이라이트 (긍정=파랑, 중립=초록, 부정=빨강)

---

## Progress Summary

| Phase | Epic 수 | 완료 | 진행률 |
|-------|---------|------|--------|
| Phase 1: Foundation | 4 | 4 | 100% |
| Phase 2: Core RAG | 4 | 4 | 100% |
| Phase 3: Agent System | 3 | 3 | 100% |
| Phase 4: UI & Polish | 4 | 4 | 100% |
| Phase 5: Deployment | 3 | 1 (+2 스킵) | 100% |
| Phase 6: Testing & Docs | 2 | 2 | 100% |
| Phase 7: Consumer Review UX | 5 | 4 | 80% |
| **Total** | **25** | **22** | **88%** |

---

## Quick Start Checklist

프로젝트 시작 시 우선 완료해야 할 최소 태스크:

- [x] 1.1.1 ~ 1.1.6: 환경 설정 ✅
- [x] 1.2.1 ~ 1.2.9: 웹 크롤러 ✅ (봇 탐지로 제한적)
- [x] 1.3.1 ~ 1.3.5: AI Hub 데이터셋 통합 ✅
- [x] 1.4.1 ~ 1.4.6: 데이터 전처리 ✅
- [x] 2.1.1 ~ 2.1.6: 벡터 DB 연동 ✅
- [x] 2.2.1 ~ 2.2.7: RAG Chain ✅
- [x] 4.1.1 ~ 4.1.7: 기본 UI ✅

→ **MVP 데모 가능!** 🎉

**추가 완료 사항:**
- [x] 4.4.1 ~ 4.4.5: 쇼핑몰 스타일 UI ✅ (Issue #21)
- [x] 3.1.1 ~ 3.1.5: LangGraph 에이전트 구조 ✅
- [x] 3.2.1 ~ 3.2.5: 개별 에이전트 구현 ✅
- [x] 7.1.2 ~ 7.1.6: 제품 상세 페이지 개편 ✅
- [x] 7.2.1 ~ 7.2.4: 리뷰 신뢰도 표시 ✅
- [x] 7.4.1 ~ 7.4.2: UI 일관성 개선 ✅ (Issue #27)
- [x] 7.5.1 ~ 7.5.6: Q&A 채팅 UX 개선 ✅

---

## Notes

- 각 Phase는 순차적으로 진행하되, 독립적인 Epic은 병렬 진행 가능
- Task 완료 시 체크박스 업데이트 및 커밋
- 예상치 못한 이슈 발생 시 해당 Epic에 Task 추가

---

*최종 업데이트: 2026-01-14 (Epic 7.5: Q&A 채팅 UX 개선 완료 - 카카오톡 스타일 채팅, 로딩 스피너, 하이라이트)*
