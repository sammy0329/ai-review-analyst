# Project Tasks

> AI Review Analyst 프로젝트 작업 관리 문서

**범례:**
- [ ] 미완료
- [x] 완료
- Phase > Epic > Task 계층 구조

---

## Phase 1: Foundation (프로젝트 기반 구축)

### Epic 1.1: 프로젝트 환경 설정

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 1.1.1 | [x] Python 가상환경 생성 | 완료 | `python -m venv venv` |
| 1.1.2 | [x] requirements.txt 작성 | 완료 | 의존성 패키지 정의 |
| 1.1.3 | [x] .env.example 생성 | 완료 | 환경 변수 템플릿 |
| 1.1.4 | [x] .gitignore 설정 | 완료 | venv, .env, __pycache__ 등 |
| 1.1.5 | [x] 프로젝트 디렉토리 구조 생성 | 완료 | src/, tests/, data/ 등 |
| 1.1.6 | [x] config.py 설정 모듈 작성 | 완료 | pydantic-settings 활용 |

**완료 기준:** `pip install -r requirements.txt` 실행 시 에러 없이 설치 완료

---

### Epic 1.2: 웹 크롤러 개발

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 1.2.1 | [x] Playwright 설치 및 브라우저 설정 | 완료 | `playwright install chromium` |
| 1.2.2 | [x] 기본 크롤러 클래스 구현 | 완료 | `src/crawler/base.py` |
| 1.2.3 | [x] 올웨이즈 리뷰 크롤러 구현 | 완료 | 동적 페이지 스크롤 처리 |
| 1.2.4 | [x] 쿠팡 리뷰 크롤러 구현 | 완료 | 플랫폼별 파서 분리 |
| 1.2.5 | [x] 크롤링 에러 핸들링 | 완료 | 재시도, 타임아웃 처리 |
| 1.2.6 | [x] User-Agent 로테이션 구현 | 완료 | 차단 우회 전략 |
| 1.2.7 | [x] 크롤러 단위 테스트 작성 | 완료 | `tests/test_crawler.py` |
| 1.2.8 | [x] playwright-stealth 통합 | 완료 | 봇 탐지 우회 강화 |
| 1.2.9 | [x] 인간적 행동 패턴 구현 | 완료 | 랜덤 딜레이, 스크롤 |

**완료 기준:** URL 입력 시 리뷰 데이터 JSON 형태로 추출 성공

**⚠️ 알려진 한계점:**
- **쿠팡**: 강력한 봇 탐지 시스템(Akamai) 사용으로 headless 브라우저 차단
  - 프록시 서비스 또는 CAPTCHA 해결 서비스 필요
  - 프로덕션 환경에서는 공식 API 또는 파트너십 고려 권장
- **올웨이즈**: 모바일 앱 중심 서비스로 웹 버전 제한적
- **11번가/네이버쇼핑**: 봇 탐지로 접속 차단

**💡 대안:** 크롤링 한계로 인해 **AI Hub 공개 데이터셋**을 활용하여 RAG 파이프라인 및 에이전트 시스템 개발에 집중

---

### Epic 1.3: 공개 데이터셋 통합 (AI Hub) ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 1.3.1 | [x] AI Hub 회원가입 및 데이터 신청 | 완료 | 승인 완료 |
| 1.3.2 | [x] 데이터셋 다운로드 | 완료 | `data/aihub_data/` |
| 1.3.3 | [x] 데이터 포맷 변환 | 완료 | `src/pipeline/aihub_loader.py` |
| 1.3.4 | [x] 카테고리별 데이터 분리 | 완료 | 패션/화장품/가전/IT/생활용품 |
| 1.3.5 | [x] 샘플 데이터 생성 | 완료 | `data/aihub_sample*.json` |

**데이터셋 정보:**
- **출처:** [AI Hub - 속성기반 감정분석 데이터](https://aihub.or.kr/aihubdata/data/view.do?dataSetSn=71603)
- **실제 규모:** 225,285건 (쇼핑몰 90% + SNS 10%)
- **카테고리:** 패션, 화장품, 가전, IT기기, 생활용품 (각 약 20%)
- **라벨:** 속성별 감정 태깅 (가격, 디자인, 기능, 품질, 색상 등)
- **형식:** JSON
- **활용:** RAG 학습, 속성별 감성 분석, 상품 비교

**생성된 파일:**
- `src/pipeline/aihub_loader.py`: AI Hub 데이터 로더 클래스
- `data/aihub_sample.json`: 통합 샘플 (1,000건)
- `data/aihub_sample_{카테고리}.json`: 카테고리별 샘플 (각 200건)

---

### Epic 1.4: 데이터 전처리 파이프라인 ✅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 1.4.1 | [x] 리뷰 텍스트 정제 함수 | 완료 | 특수문자, 이모지 처리 |
| 1.4.2 | [x] 텍스트 청킹(Chunking) 로직 | 완료 | 의미 단위 분할 |
| 1.4.3 | [x] 메타데이터 추출 | 완료 | 별점, 날짜, 구매옵션 |
| 1.4.4 | [x] 중복 리뷰 필터링 | 완료 | 해시 기반 중복 제거 |
| 1.4.5 | [x] 전처리 파이프라인 클래스 | 완료 | `src/pipeline/preprocessor.py` |
| 1.4.6 | [x] 전처리 단위 테스트 | 완료 | `tests/test_preprocessor.py` |

**완료 기준:** 원본 리뷰 → 정제된 청크 리스트 변환 정상 동작

**구현 내용:**
- `TextCleaner`: 텍스트 정제 클래스 (이모지, 특수문자, 반복문자, HTML 엔티티 처리)
- `TextChunker`: 텍스트 청킹 클래스 (문장 단위 분할, 오버랩 지원)
- `DuplicateFilter`: 중복 필터링 클래스 (해시 기반 + 퍼지 매칭)
- `ReviewPreprocessor`: 통합 파이프라인 클래스
- 39개 단위 테스트 전체 통과

---

## Phase 2: Core RAG (검색 증강 생성 구현)

### Epic 2.1: Vector Database 구축

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 2.1.1 | [ ] ChromaDB 설치 및 초기화 | 대기 | 영속적 저장소 설정 |
| 2.1.2 | [ ] OpenAI 임베딩 연동 | 대기 | text-embedding-3-small |
| 2.1.3 | [ ] 임베딩 파이프라인 구현 | 대기 | `src/pipeline/embedder.py` |
| 2.1.4 | [ ] 컬렉션 관리 유틸리티 | 대기 | 생성, 삭제, 조회 |
| 2.1.5 | [ ] 메타데이터 필터링 구현 | 대기 | 별점, 날짜 기반 필터 |
| 2.1.6 | [ ] 벡터 검색 테스트 | 대기 | 유사도 검색 정확도 확인 |

**완료 기준:** 자연어 쿼리로 관련 리뷰 Top-K 검색 성공

---

### Epic 2.2: LangChain RAG Chain 구현

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 2.2.1 | [ ] LangChain 기본 설정 | 대기 | ChatOpenAI 초기화 |
| 2.2.2 | [ ] Retriever 구성 | 대기 | ChromaDB 연동 |
| 2.2.3 | [ ] 프롬프트 템플릿 설계 | 대기 | 시스템/유저 프롬프트 |
| 2.2.4 | [ ] RetrievalQA Chain 구현 | 대기 | `src/chains/rag_chain.py` |
| 2.2.5 | [ ] 출처(Source) 반환 로직 | 대기 | 참고 리뷰 원문 표기 |
| 2.2.6 | [ ] Chain 스트리밍 설정 | 대기 | 실시간 응답 출력 |
| 2.2.7 | [ ] RAG Chain 통합 테스트 | 대기 | E2E 질의응답 테스트 |

**완료 기준:** "배송이 빠른가요?" 질문에 리뷰 근거 기반 답변 생성

---

### Epic 2.3: 프롬프트 엔지니어링

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 2.3.1 | [ ] Q&A 시스템 프롬프트 작성 | 대기 | 역할, 제약조건 정의 |
| 2.3.2 | [ ] 요약 프롬프트 작성 | 대기 | 수치화 근거 포함 지시 |
| 2.3.3 | [ ] 비교 분석 프롬프트 작성 | 대기 | 장단점 비교 포맷 |
| 2.3.4 | [ ] 할루시네이션 방지 지시문 | 대기 | "모르면 모른다고 답변" |
| 2.3.5 | [ ] Few-shot 예시 추가 | 대기 | 답변 품질 향상 |
| 2.3.6 | [ ] 프롬프트 버전 관리 | 대기 | prompts/ 디렉토리 구성 |

**완료 기준:** 일관된 포맷과 품질의 답변 생성

---

## Phase 3: Agent System (멀티 에이전트 구현)

### Epic 3.1: LangGraph 기반 에이전트 구조

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 3.1.1 | [ ] AgentState 정의 | 대기 | TypedDict 상태 스키마 |
| 3.1.2 | [ ] Intent Classifier 노드 | 대기 | 사용자 의도 분류 |
| 3.1.3 | [ ] Conditional Router 구현 | 대기 | 의도별 에이전트 분기 |
| 3.1.4 | [ ] StateGraph 구성 | 대기 | 노드/엣지 연결 |
| 3.1.5 | [ ] 그래프 시각화 테스트 | 대기 | Mermaid 다이어그램 |

**완료 기준:** 질문 유형에 따라 올바른 에이전트로 라우팅

---

### Epic 3.2: 개별 에이전트 구현

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 3.2.1 | [ ] Summarize Agent 구현 | 대기 | 리뷰 요약 전용 |
| 3.2.2 | [ ] Q&A Agent 구현 | 대기 | RAG 기반 질의응답 |
| 3.2.3 | [ ] Compare Agent 구현 | 대기 | 상품 비교 분석 |
| 3.2.4 | [ ] 에이전트 공통 인터페이스 | 대기 | BaseAgent 추상 클래스 |
| 3.2.5 | [ ] 에이전트 단위 테스트 | 대기 | 각 에이전트별 테스트 |

**완료 기준:** 3가지 에이전트가 독립적으로 동작

---

### Epic 3.3: 가짜 리뷰 필터링

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 3.3.1 | [ ] 어뷰징 패턴 정의 | 대기 | 반복 문구, 과도한 칭찬 |
| 3.3.2 | [ ] LLM 기반 분류기 구현 | 대기 | 신뢰도 점수 산출 |
| 3.3.3 | [ ] 필터링 임계값 설정 | 대기 | 가중치 조절 로직 |
| 3.3.4 | [ ] 필터링 파이프라인 통합 | 대기 | 전처리 단계에 적용 |

**완료 기준:** 의심 리뷰 필터링 또는 가중치 감소 적용

---

## Phase 4: UI & Polish (사용자 인터페이스)

### Epic 4.1: Streamlit 대시보드

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 4.1.1 | [ ] 기본 레이아웃 구성 | 대기 | 헤더, 사이드바, 메인 |
| 4.1.2 | [ ] URL 입력 컴포넌트 | 대기 | 단일/다중 URL 지원 |
| 4.1.3 | [ ] 로딩 상태 표시 | 대기 | 스피너, 프로그레스 바 |
| 4.1.4 | [ ] 요약 리포트 카드 | 대기 | 긍/부정 비율, 키워드 |
| 4.1.5 | [ ] 차트 시각화 | 대기 | bar chart, pie chart |
| 4.1.6 | [ ] 채팅 인터페이스 | 대기 | st.chat_message 활용 |
| 4.1.7 | [ ] 세션 상태 관리 | 대기 | 대화 히스토리 유지 |

**완료 기준:** URL 입력 → 요약 → 채팅 플로우 정상 동작

---

### Epic 4.2: UX 개선

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 4.2.1 | [ ] 스트리밍 응답 구현 | 대기 | st.write_stream 활용 |
| 4.2.2 | [ ] 에러 메시지 사용자화 | 대기 | 친절한 에러 안내 |
| 4.2.3 | [ ] 출처 리뷰 펼쳐보기 | 대기 | expander 컴포넌트 |
| 4.2.4 | [ ] 분석 결과 다운로드 | 대기 | JSON/CSV 내보내기 |
| 4.2.5 | [ ] 반응형 디자인 조정 | 대기 | 모바일 대응 |
| 4.2.6 | [ ] 다크모드 지원 | 대기 | 테마 설정 |

**완료 기준:** 사용자 피드백 기반 UX 개선 완료

---

### Epic 4.3: 에러 핸들링 및 로깅

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 4.3.1 | [ ] 로깅 설정 | 대기 | logging 모듈 구성 |
| 4.3.2 | [ ] 예외 클래스 정의 | 대기 | 커스텀 Exception |
| 4.3.3 | [ ] API 에러 처리 | 대기 | OpenAI rate limit 등 |
| 4.3.4 | [ ] 크롤링 실패 처리 | 대기 | 재시도, 폴백 |
| 4.3.5 | [ ] 사용자 알림 시스템 | 대기 | st.error, st.warning |

**완료 기준:** 모든 예상 에러 케이스에 대한 graceful 처리

---

## Phase 5: Deployment (배포)

### Epic 5.1: 컨테이너화

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 5.1.1 | [ ] Dockerfile 작성 | 대기 | Python + Playwright |
| 5.1.2 | [ ] docker-compose.yml 작성 | 대기 | 환경 변수 주입 |
| 5.1.3 | [ ] .dockerignore 설정 | 대기 | 불필요 파일 제외 |
| 5.1.4 | [ ] 로컬 Docker 빌드 테스트 | 대기 | `docker-compose up` |
| 5.1.5 | [ ] 볼륨 마운트 설정 | 대기 | ChromaDB 영속성 |

**완료 기준:** 로컬에서 Docker 컨테이너 정상 실행

---

### Epic 5.2: AWS EC2 배포

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 5.2.1 | [ ] EC2 인스턴스 생성 | 대기 | t2.micro (Free Tier) |
| 5.2.2 | [ ] 보안 그룹 설정 | 대기 | 포트 8501 오픈 |
| 5.2.3 | [ ] Docker 설치 | 대기 | EC2에 Docker 세팅 |
| 5.2.4 | [ ] 소스 코드 배포 | 대기 | git clone 또는 SCP |
| 5.2.5 | [ ] 환경 변수 설정 | 대기 | .env 파일 생성 |
| 5.2.6 | [ ] 컨테이너 실행 | 대기 | docker-compose up -d |
| 5.2.7 | [ ] 도메인 연결 (선택) | 대기 | Route53 또는 외부 DNS |

**완료 기준:** 퍼블릭 IP로 서비스 접속 가능

---

### Epic 5.3: 운영 및 모니터링

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 5.3.1 | [ ] 헬스체크 엔드포인트 | 대기 | 서비스 상태 확인 |
| 5.3.2 | [ ] 로그 수집 설정 | 대기 | CloudWatch 또는 파일 |
| 5.3.3 | [ ] 자동 재시작 설정 | 대기 | restart: unless-stopped |
| 5.3.4 | [ ] 백업 스크립트 작성 | 대기 | ChromaDB 데이터 백업 |
| 5.3.5 | [ ] 배포 자동화 (선택) | 대기 | GitHub Actions CI/CD |

**완료 기준:** 안정적인 서비스 운영 환경 구축

---

## Phase 6: Testing & Documentation (테스트 및 문서화)

### Epic 6.1: 테스트

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 6.1.1 | [ ] pytest 설정 | 대기 | pytest.ini, conftest.py |
| 6.1.2 | [ ] 단위 테스트 작성 | 대기 | 각 모듈별 테스트 |
| 6.1.3 | [ ] 통합 테스트 작성 | 대기 | E2E 시나리오 테스트 |
| 6.1.4 | [ ] 테스트 커버리지 측정 | 대기 | pytest-cov |
| 6.1.5 | [ ] RAG 품질 평가 | 대기 | Retrieval Accuracy 측정 |

**완료 기준:** 테스트 커버리지 80% 이상

---

### Epic 6.2: 문서화

| Task ID | Task | 상태 | 설명 |
|---------|------|------|------|
| 6.2.1 | [x] README.md 작성 | 완료 | 프로젝트 소개 |
| 6.2.2 | [x] PRD.md 작성 | 완료 | 요구사항 문서 |
| 6.2.3 | [x] TechStack.md 작성 | 완료 | 기술 스택 문서 |
| 6.2.4 | [x] Tasks.md 작성 | 완료 | 작업 관리 문서 |
| 6.2.5 | [ ] API 문서 작성 | 대기 | 내부 API 명세 |
| 6.2.6 | [ ] 사용자 가이드 작성 | 대기 | 사용법 안내 |

**완료 기준:** 신규 개발자가 문서만으로 프로젝트 이해 가능

---

## Progress Summary

| Phase | Epic 수 | 완료 | 진행률 |
|-------|---------|------|--------|
| Phase 1: Foundation | 4 | 4 | 100% |
| Phase 2: Core RAG | 3 | 0 | 0% |
| Phase 3: Agent System | 3 | 0 | 0% |
| Phase 4: UI & Polish | 3 | 0 | 0% |
| Phase 5: Deployment | 3 | 0 | 0% |
| Phase 6: Testing & Docs | 2 | 1 | 50% |
| **Total** | **18** | **5** | **28%** |

---

## Quick Start Checklist

프로젝트 시작 시 우선 완료해야 할 최소 태스크:

- [x] 1.1.1 ~ 1.1.6: 환경 설정 ✅
- [x] 1.2.1 ~ 1.2.9: 웹 크롤러 ✅ (봇 탐지로 제한적)
- [x] 1.3.1 ~ 1.3.5: AI Hub 데이터셋 통합 ✅
- [x] 1.4.1 ~ 1.4.6: 데이터 전처리 ✅
- [ ] 2.1.1 ~ 2.1.3: 벡터 DB 연동
- [ ] 2.2.1 ~ 2.2.4: RAG Chain
- [ ] 4.1.1 ~ 4.1.6: 기본 UI

→ 위 태스크 완료 시 **MVP 데모 가능**

---

## Notes

- 각 Phase는 순차적으로 진행하되, 독립적인 Epic은 병렬 진행 가능
- Task 완료 시 체크박스 업데이트 및 커밋
- 예상치 못한 이슈 발생 시 해당 Epic에 Task 추가

---

*최종 업데이트: 2025-01-10*
